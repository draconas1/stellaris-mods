# condan_events.txt  Contingency Processing Core 1A6F
# Stellaris 2024 ModJam
# Contributors: Draconas

namespace = condan_events

# repair planet
planet_event = {
    id = condan_events.010
    title = condan_events.010.title
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        if = {
            limit = { has_modifier = condan_leader_trapped}
            remove_modifier = condan_leader_trapped
            planet_event = { id = condan_events.030 }
        }
        else = {
            planet_event = { id = condan_events.020 }
        }
    }
}

# No Condan
planet_event = {
    id = condan_events.020
    title = condan_events.020.title
    desc = condan_events.020.desc
    picture = GFX_evt_ancient_databank
    is_triggered_only = yes

    option = {
        name = OK
    }
}



country_event = {
    id = condan_events.030
    title = condan_events.030.title
    desc = condan_events.030.desc
    picture = GFX_evt_ancient_databank

    diplomatic = yes
    #fire_only_once = yes
    is_triggered_only = yes

    picture = GFX_leader_recruitment_bg_legendary_keides
    event_window_type = leader_recruit

    picture_event_data = {
        portrait = event_target:legendary_lost_leader
        room = galactic_custodian_room
    }

    immediate = {
        create_leader = {
            class = offical
            species = event_target:condan_bot
            name = "NAME_CONDAN"
            skill = 10
            gender = indeterminable
            event_leader = yes
            immortal = yes
            randomize_traits = no
            skip_background_generation = yes
            custom_catch_phrase = condan_catch_phrase
            custom_description = desc_condan
            set_age = 0
            hide_age = yes
            background_ethic = ethic_gestalt_consciousness
            traits = {
                trait = leader_trait_synthetic
                trait = leader_trait_urbanist
                trait = subclass_official_governor
                trait = leader_trait_forge_focus_3
                trait = leader_trait_manufacturer_3
                trait = leader_trait_assembler_3
                trait = leader_trait_sadistic_2
            }

            effect = {
                set_leader_flag = legendary_leader
                set_leader_flag = condan
                set_leader_flag = immune_to_negative_traits
                save_global_event_target_as = condan_leader
                set_owner = root
                exile_leader_as = condan_leader
            }
        }

        root = {
            create_message = {
                type = MESSAGE_RECRUITED_LEADER
                localization =  MESSAGE_RECRUITED_LEADER_DESC
                days = @toast_message_days
                target = event_target:condan_leader
                variable = {
                    type = name
                    localization = LEADER
                    scope = event_target:condan_leader
                }
                variable = {
                    key = "border"
                    value = "GFX_border_legendary"
                }
            }
        }
    }

    option = {
        # Special tag to make mark this is the hire option
        name = HIRE
        tag = hire_leader
        #sound = "par_beholder_hire"

        hidden_effect = {
            clone_leader = {
                target = event_target:condan_leader
            }
            last_created_leader = {
                set_leader_flag = condan
                set_leader_flag = legendary_leader
                save_global_event_target_as = condan_leader
                set_leader_flag = immune_to_negative_traits
                set_owner = root

                if = {
                    limit = {
                        root = {
                             NOT = { has_authority = auth_machine_intelligence}
                        }
                    }
                    add_trait = leader_trait_pop_focused_3
                }
                else = {
                    # TODO
                }
            }
            set_global_flag = condan_recruited
        }

        create_message = {
            type = MESSAGE_RECRUITED_LEADER
            localization =  MESSAGE_RECRUITED_LEADER_DESC
            days = @toast_message_days
            target = event_target:condan_leader
            variable = {
                type = name
                localization = LEADER
                scope = event_target:condan_leader
            }
            variable = {
                key = "border"
                value = "GFX_border_legendary"
            }
        }
    }

    option = {
        name = DISMISS
        # Special tag to mark this as the dismiss option
        tag = dismiss_leader
#        sound = "par_keides_dismiss"

        hidden_effect = {
            event_target:condan_leader = {
                kill_leader = { show_notification = no }
            }
        }
    }


}